<!DOCTYPE html>
<html lang="en" data-bs-theme="light"> <!-- data-bs-theme="dark/light" -->
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="online, gamma, spectroscopy, spectrometry, scintillator, mca, open-source, physics, science, web, application, particle-physics, nuclear, radiation, serial, spectrum, radiation, multi-channel analyzer">
    <meta name="description" content="Gamma MCA is a free and complete progressive web app for gamma spectroscopy. You can import spectrum files and record new ones using the serial interface.">
    <meta name="author" content="NuclearPhoenix">
    <meta name="robots" content="index, follow">
  	<meta name="title" content="Gamma MCA - Gamma-ray spectroscopy">
  	<meta name="language" content="English">
    <!--
      CSP: Only allow loading resources from this website.
      Style-src: unsafe-inline needed for Plotly.js styles.
      Img-src needs data: and blob: otherwise it cannot load some images.
      Connect-src is used for fetch (Custom isotope list URL) - * allow all.
    -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self';
                                                        style-src 'self' 'unsafe-inline';
                                                        img-src 'self' data: blob: https://hits.seeyoufarm.com/api/count/incr/badge.svg;
                                                        connect-src * ">

    <link rel="apple-touch-icon" sizes="180x180" href="/assets/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon/favicon-16x16.png">
    <link rel="mask-icon" href="/assets/favicon/safari-pinned-tab.svg" color="#5bbad5">
    <link rel="shortcut icon" href="/assets/favicon/favicon.ico">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="/assets/favicon/browserconfig.xml">
    <meta name="theme-color" content="#f6bd16">

    <title>Gamma MCA - Gamma-ray spectroscopy</title>

    <link rel="stylesheet" href="/assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="/assets/css/all.min.css">
    <link rel="stylesheet" href="/assets/css/main.css">

    <link rel="manifest" href="/site.webmanifest">

    <script defer src="/assets/js/external/bootstrap.min.js"></script>
    <script defer src="/assets/js/external/plotly-basic.min.js"></script>
    <!--
      ZSchema will only be imported when it is needed
      <script defer src="/assets/js/external/ZSchema-browser-min.js"></script>
    -->
    <!-- The defer attribute has no effect on module scripts â€” they defer by default -->
    <script type="module" src="/assets/js/raw-data.js"></script>
    <script type="module" src="/assets/js/plot.js"></script>
    <script type="module" src="/assets/js/serial.js"></script>
    <script type="module" src="/assets/js/main.js"></script>
  </head>
  <body>
    <!--

      LOADING AND NOSCRIPT ALERT

    -->
    <div id="loading" class="vh-100 vw-100 fixed-top">
      <div id="text-window" class="position-absolute top-50 start-50 translate-middle mx-auto pt-3 pb-3 ps-5 pe-5 text-center text-bg-light border border-2 rounded-2 border-primary">

        <noscript>
          <p class="fs-3 text-bg-danger text-center">
            This website only works with Javascript enabled! You need to enable it in your browser to be able to use this site!
            <br>
            Instructions on how to do this can be found <a class="link-light link-offset-2 link-underline-opacity-25 link-underline-opacity-100-hover" title="Enable-Javascript.com" href="https://enable-javascript.com/" target="_blank">&lt;here&gt;</a>.
          </p>
        </noscript>

        <p class="fs-2">LOADING</p>
        <div id="loading-spinner" class="fs-5 spinner-border text-primary" role="status">
          <span class="visually-hidden">Loading...</span>
        </div>

      </div>
      <div class="vh-100 vw-100 text-bg-dark bg-opacity-75"></div>
    </div>
    <!--

      MAIN PAGE CONTENT

    -->
    <div class="container-fluid flex-column d-flex vh-100 pb-1 p-1 lh-sm main" id="main"> <!-- pb-1 needed for vertical scroll bar -->
      <div class="row border border-1 border-dark border-bottom-0 rounded-top-3 border-mode border-theme">

        <div class="col-md-auto p-2 text-center">

          <h2 class="fs-4">Menu</h2>

          <nav class="nav nav-pills flex-column" id="main-tabs" role="tablist" aria-orientation="vertical">
            <button class="nav-link active mb-1 fw-semibold border border-1 rounded-1 border-primary shadow-sm" id="file-import-tab" data-bs-toggle="pill" data-bs-target="#v-file" type="button" role="tab" aria-controls="v-file" aria-selected="true" title="Select File Import Tab">
              <i class="fa-solid fa-file-import"></i> File Control
            </button>

            <button class="nav-link mb-1 fw-semibold border border-1 rounded-1 border-primary shadow-sm" id="serial-tab" data-bs-toggle="pill" data-bs-target="#v-serial" type="button" role="tab" aria-controls="v-serial" aria-selected="false" title="Select Serial Connection Tab">
              <i class="fa-solid fa-network-wired"></i> Serial Connection

              <span class="align-middle border border-light rounded-circle spinner-grow spinner-grow-sm recording-spinner text-danger d-none" role="status">
                <span class="visually-hidden">Recording...</span>
              </span>

            </button>

            <button class="nav-link mb-1 fw-semibold border border-1 rounded-1 border-primary shadow-sm" id="calibration-tab" data-bs-toggle="pill" data-bs-target="#v-calibration" type="button" role="tab" aria-controls="v-calibration" aria-selected="false" title="Select Calibration Tab">
              <i class="fa-solid fa-calculator"></i> Calibration
            </button>

            <button class="nav-link fw-semibold border border-1 rounded-1 border-primary shadow-sm" id="metadata-tab" data-bs-toggle="pill" data-bs-target="#v-metadata" type="button" role="tab" aria-controls="v-metadata" aria-selected="false" title="Select Sample Information Tab">
              <i class="fa-solid fa-circle-info"></i> Sample Info
            </button>
          </nav>

          <hr>

          <button class="btn btn-sm btn-outline-primary rounded-1 w-100 fw-semibold shadow-sm" id="toggle-menu" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvas" aria-controls="offcanvas" title="Open Settings Menu">
            <i class="fa-solid fa-gear"></i> Settings
          </button>

        </div>

        <div class="col-md-auto g-0 bg-dark border-theme">
          <div class="vr h-100 d-none d-md-block"></div>
          <hr class="d-md-none m-0">
        </div>

        <div class="col-md p-3">

          <div class="tab-content h-100">
            <div class="tab-pane fade show active h-100" id="v-file" role="tabpanel" aria-labelledby="file-import-tab">
              <!--
                ###############
                FILE IMPORT TAB
                ###############
              -->
              <div class="row h-100">
                <div class="col">
                  <!--
                    #####
                    COL 1
                    #####
                  -->
                  <p>
                    <label id="data-label" for="data"><strong>Spectrum File:</strong> <i id="data-icon" class="fa-solid fa-circle-check align-baseline text-primary d-none fa-beat file-import-success"></i></label>
                  </p>

                  <div class="input-group input-group-sm">
                    <label for="data" class="btn btn-sm btn-primary" title="Import a file"> <i class="fas fa-file-import"></i> Open File </label>
                    <label class="cursor-pointer form-control text-truncate" for="data" id="data-form-label">No File Chosen</label>

                    <button class="btn btn-primary btn-sm" type="button" id="clear-data" title="Remove File"> <i class="fas fa-trash"></i> Clear</button>
                  </div>
                  <input class="d-none" type="file" id="data" accept=".csv, .tka, .xml, .txt, .json">

                  <br>

                  <p>
                    <label id="background-label" for="background"><strong>Background File:</strong> <i id="background-icon" class="fa-solid fa-circle-check align-baseline text-primary d-none fa-beat file-import-success"></i></label>
                  </p>

                  <div class="input-group input-group-sm">
                    <label for="background" class="btn btn-sm btn-primary" title="Import a file"> <i class="fas fa-file-import"></i> Open File </label>
                    <label class="cursor-pointer form-control text-truncate" for="background" id="background-form-label">No File Chosen</label>

                    <button class="btn btn-primary btn-sm" type="button" id="clear-bg" title="Remove File"> <i class="fas fa-trash"></i> Clear</button>
                  </div>
                  <input class="d-none" type="file" id="background" accept=".csv, .tka, .xml, .txt, .json">

                  <hr>

                  <p>
                    <button class="btn btn-primary btn-sm" id="export-button" type="button" data-bs-toggle="modal" data-bs-target="#exportModal" title="Save file as ...">
                      <i class="fas fa-file-export"></i> Save As
                    </button>

                    <button class="btn btn-primary btn-sm" id="overwrite-button" type="button" title="Save file: Overwrite file(s)!" disabled>
                      <i class="fas fa-file-export"></i> Save
                    </button>
                  </p>

                </div>

                <div class="col-lg-auto g-0">
                  <div class="vr h-100 d-none d-lg-block"></div>
                  <hr class="d-lg-none">
                </div>

                <div class="col">
                  <!--
                    #####
                    COL 2
                    #####
                  -->
                  <p><strong>File Type (CSVs only):</strong></p>

                  <p>
                    <input id="r1" class="form-check-input" type="radio" value="2" name="filetype">
                    <label class="form-check-label align-middle" for="r1">Chronological Stream (e.g. Serial)</label>
                  </p>

                  <p>
                    <input id="r2" class="form-check-input" type="radio" value="1" name="filetype" checked="checked">
                    <label class="form-check-label align-middle" for="r2">Histogram (e.g. CSV, TKA, XML, JSON)</label>
                  </p>

                </div>
              </div>

            </div>
            <div class="tab-pane fade h-100" id="v-serial" role="tabpanel" aria-labelledby="serial-tab">
              <!--
               #####################
               SERIAL CONNECTION TAB
               #####################
              -->
              <div class="alert alert-warning" role="alert" id="serial-error">
                <p>Oh no! Looks like neither the <a class="link-primary link-offset-2 link-underline-opacity-25 link-underline-opacity-100-hover" href="https://caniuse.com/web-serial" target="_blank" title="CanIUse? Web Serial API"> Web Serial API</a>, 
                  nor <a class="link-primary link-offset-2 link-underline-opacity-25 link-underline-opacity-100-hover" href="https://caniuse.com/webusb" target="_blank" title="CanIUse? WebUSB">WebUSB</a> are not supported in your browser.</p>
                
                <p>Please switch to the latest Chromium-based browser (e.g. Chrome, Edge, etc.) or enable one of the features in your browser's settings if possible.
                  Otherwise you cannot use any serial devices.</p>
              </div>

              <div id="serial-div" class="h-100">

               <div class="row h-100">
                 <div class="col">
                   <!--
                     #####
                     COL 1
                     #####
                   -->
                    <p>
                      <strong>Select Port:</strong>
                    </p>

                    <div class="input-group input-group-sm">

                      <button class="btn btn-primary btn-sm" type="button" id="serial-list-btn" title="Refresh List"> <i class="fas fa-sync"></i> </button>
                      <select class="form-select form-select-sm ser-settings" id="port-selector" aria-label=".form-select-sm example" title="Choose a serial device">
                        <!-- NOTHING -->
                      </select>
                      <button class="btn btn-primary btn-sm" type="button" id="serial-add-device" title="Add new device"> <i class="fas fa-plus"></i> Add </button>

                    </div>

                    <br>

                    <div class="clearfix">

                      <button class="btn btn-primary btn-sm ser-settings" id="record-button" type="button" data-bs-toggle="modal" data-bs-target="#recordModal" title="Start recording"> <i class="fas fa-play"></i> Record </button>
                      <button class="btn btn-primary btn-sm ser-settings d-none" id="pause-button" type="button" title="Pause recording"> <i class="fas fa-pause"></i> Pause </button>
                      <button class="btn btn-primary btn-sm ser-settings d-none" id="resume-button" type="button" title="Resume recording"> <i class="fas fa-play fa-beat-fade"></i> Resume </button>
                      <button class="btn btn-primary btn-sm" id="stop-button" type="button" title="Stop recording" disabled> <i class="fas fa-stop"></i> Stop </button>

                      <div class="spinner-grow spinner-grow-sm text-danger align-middle recording-spinner d-none" role="status">
                        <span class="visually-hidden">Recording...</span>
                      </div>

                      <div class="float-end">

                        <div class="vstack align-middle">
                          <span class="align-middle fw-bold"><span id="record-time"></span><span id="total-record-time"></span></span>

                          <div class="progress mt-1" id="ser-time-progress-bar" role="progressbar" title="Serial recording progress" aria-label="Serial recording progress" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
                            <div class="progress-bar text-bg-primary" id="ser-time-progress"></div>
                          </div>
                        </div>

                      </div>

                    </div>

                    <hr>

                    <div class="clearfix">

                      <button class="btn btn-primary btn-sm ser-settings" type="button" data-bs-toggle="modal" data-bs-target="#serialConsoleModal" title="Serial Console" id="open-console" disabled>
                        <i class="fa-solid fa-terminal"></i> Console
                      </button>

                      <div class="float-end">
                        <div class="vstack align-middle text-end">

                          <span class="align-middle fw-bold" id="cps"></span>
                          <span class="align-middle"><span id="avg-cps"></span><span id="avg-cps-std"></span></span>

                        </div>
                      </div>

                    </div>

                  </div>

                  <div class="col-lg-auto g-0">
                    <div class="vr h-100 d-none d-lg-block"></div>
                    <hr class="d-lg-none">
                  </div>

                  <div class="col">
                    <!--
                      #####
                      COL 2
                      #####
                    -->
                    <p><strong>Data Order:</strong></p>

                    <p>
                      <input id="s1" class="form-check-input" type="radio" value="chron" name="serialtype" checked="checked">
                      <label class="form-check-label align-middle" for="s1">Chronological Mode (serial events in succession)</label>
                    </p>

                    <p>
                      <input id="s2" class="form-check-input" type="radio" value="hist" name="serialtype">
                      <label class="form-check-label align-middle" for="s2">Histogram Mode (serial data is histogram)</label>
                    </p>

                    <hr>

                    <input type="checkbox" class="btn-check" id="toggle-evolution-chart" disabled>
                    <label class="btn btn-outline-primary btn-sm" title="Show Evolution Chart" id="toggle-evol-chart-label" for="toggle-evolution-chart"> <i class="fa-solid fa-eye"></i> Show Evolution </label>

                  </div>
                </div>

              </div>

            </div>
            <div class="tab-pane fade h-100" id="v-calibration" role="tabpanel" aria-labelledby="calibration-tab">
              <!--
                ###############
                CALIBRATION TAB
                ###############
              -->
              <div class="row h-100">
                <div class="col">
                  <!--
                    #####
                    COL 1
                    #####
                  -->
                  <p class="text-center fs-6 fw-bold mb-1 text-bg-primary rounded d-none" id="calibration-title">IMPORTED FROM FILE</p>
                  <form>

                    <div class="vstack gap-1">

                      <div class="hstack gap-2">
                        <div class="input-group input-group-sm">
                          <label class="input-group-text" for="adc-a">A:</label>
                          <input class="form-control form-control-sm cal-setting" type="number" id="adc-a" min="0" value="" title="Input ADC Channel A" placeholder="Data Point A">
                          <input type="checkbox" class="btn-check cal-setting" id="select-a">
                          <label class="btn btn-outline-primary" for="select-a" title="Select from plot"> <i class="fa-solid fa-arrow-pointer"></i> </label>
                        </div>

                        <span> <i class="fa-solid fa-angles-right"></i> </span>

                        <div class="input-group input-group-sm">
                          <input class="form-control form-control-sm cal-setting" type="number" id="cal-a" min="1" value="" title="Energy for channel A" placeholder="Target Energy A">
                          <label class="input-group-text" for="cal-a">keV</label>
                        </div>
                      </div>

                      <div class="hstack gap-2">
                        <div class="input-group input-group-sm">
                          <label class="input-group-text" for="adc-b">B:</label>
                          <input class="form-control form-control-sm cal-setting" type="number" id="adc-b" min="0" value="" title="Input ADC Channel B" placeholder="Data Point B">
                          <input type="checkbox" class="btn-check cal-setting" id="select-b">
                          <label class="btn btn-outline-primary" for="select-b" title="Select from plot"> <i class="fa-solid fa-arrow-pointer"></i> </label>
                        </div>

                        <span> <i class="fa-solid fa-angles-right"></i> </span>

                        <div class="input-group input-group-sm">
                          <input class="form-control form-control-sm cal-setting" type="number" id="cal-b" min="1" value="" title="Energy for channel B" placeholder="Target Energy B">
                          <label class="input-group-text" for="cal-b">keV</label>
                        </div>
                      </div>

                      <div class="hstack gap-2">
                        <div class="input-group input-group-sm">
                          <label class="input-group-text" for="adc-c">C:</label>
                          <input class="form-control form-control-sm cal-setting" type="number" id="adc-c" min="0" value="" title="Input ADC Channel C" placeholder="Data Point C">
                          <input type="checkbox" class="btn-check cal-setting" id="select-c">
                          <label class="btn btn-outline-primary" for="select-c" title="Select from plot"> <i class="fa-solid fa-arrow-pointer"></i> </label>
                        </div>

                        <span> <i class="fa-solid fa-angles-right"></i> </span>

                        <div class="input-group input-group-sm">
                          <input class="form-control form-control-sm cal-setting" type="number" id="cal-c" min="1" value="" title="Energy for channel C" placeholder="Target Energy C">
                          <label class="input-group-text" for="cal-c">keV</label>
                        </div>
                      </div>

                    </div>

                    <hr>

                    <div class="vstack gap-2">
                      <div class="hstack gap-1">
                        <input type="checkbox" class="btn-check" id="apply-cal">
                        <label class="btn btn-outline-primary btn-sm" title="Toggle plot calibration" id="calibration-label" for="apply-cal"> <i class="fa-solid fa-check"></i> Calibrate </label>

                        <button class="btn btn-primary btn-sm" type="reset" id="calibration-reset" title="Clear calibration"> <i class="fas fa-trash"></i> Delete</button>

                        <input type="checkbox" class="btn-check" id="toggle-calibration-chart">
                        <label class="btn btn-outline-primary btn-sm" title="Show Calibration Chart" id="toggle-cal-chart-label" for="toggle-calibration-chart"> <i class="fa-solid fa-eye"></i> Show Chart </label>
                      </div>

                      <div class="hstack gap-1">
                        <label for="cal-input" class="btn btn-primary btn-sm" title="Import a calibration.json"> <i class="fas fa-file-import"></i> Import </label>
                        <input id="cal-input" class="visually-hidden" type="file" accept=".json" name="name">

                        <button class="btn btn-primary btn-sm" type="button" id="calibration-download" title="Export the calibration.json"> <i class="fas fa-file-export"></i> Export </button>
                      </div>
                    </div>

                  </form>
                </div>

                <div class="col-lg-auto g-0">
                  <div class="vr h-100 d-none d-lg-block"></div>
                  <hr class="d-lg-none">
                </div>

                <div class="col">
                  <!--
                    #####
                    COL 2
                    #####
                  -->
                  <p class="mb-1">Linear (2-point) or quadratic (3-point) calibration is supported.</p>
                  <p class="mb-1"><var>E</var> [keV] = <var>c<sub>1</sub></var> <var>x<sup>2</sup></var> + <var>c<sub>2</sub></var> <var>x</var> + <var>c<sub>3</sub></var> (<var>x</var> ... Channel Number)</p>

                  <hr>

                  <p>Coefficients will be computed automatically:</p>

                  <p class="mb-1"><var>c<sub>1</sub></var>: <span id="c1-coeff">0</span></p>
                  <p class="mb-1"><var>c<sub>2</sub></var>: <span id="c2-coeff">0</span></p>
                  <p><var>c<sub>3</sub></var>: <span id="c3-coeff">0</span></p>

                </div>
              </div>

            </div>
            <div class="tab-pane fade h-100" id="v-metadata" role="tabpanel" aria-labelledby="metadata-tab">
              <!--
                ############
                METADATA TAB
                ############
              -->
              <div class="row h-100">
                <div class="col">
                  <!--
                    #####
                    COL 1
                    #####
                  -->
                  <p><strong>Sample Information</strong></p>

                  <div class="vstack gap-2">
                    <div class="input-group input-group-sm">
                      <label class="input-group-text w-25" for="sample-name">Name</label>
                      <input type="text" class="form-control sample-info" id="sample-name" aria-label="Sample name" placeholder="Name of sample">
                    </div>

                    <div class="input-group input-group-sm">
                      <label class="input-group-text w-25" for="sample-loc">Location</label>
                      <input type="text" class="form-control sample-info" id="sample-loc" aria-label="Sample location" placeholder="Location of sample">
                    </div>

                    <div class="input-group input-group-sm">
                      <label class="input-group-text w-25" for="sample-time">Time</label>
                      <input type="datetime-local" class="form-control sample-info" id="sample-time" aria-label="Sample time">
                    </div>

                    <div class="input-group input-group-sm">
                      <label class="input-group-text w-25" for="sample-weight">Weight</label>
                      <input type="number" min="0" step="0.1" class="form-control sample-info" id="sample-weight" aria-label="Sample weight" placeholder="Sample weight [g]">
                    </div>

                    <div class="input-group input-group-sm">
                      <label class="input-group-text w-25" for="sample-vol">Volume</label>
                      <input type="number" min="0" step="0.1" class="form-control sample-info" id="sample-vol" aria-label="Sample volume" placeholder="Sample volume [cm^3]">
                    </div>
                  </div>

                </div>

                <div class="col-lg-auto g-0">
                  <div class="vr h-100 d-none d-lg-block"></div>
                  <hr class="d-lg-none">
                </div>

                <div class="col">
                  <!--
                    #####
                    COL 2
                    #####
                  -->
                  <p><strong>Device Information</strong></p>

                  <div class="input-group input-group-sm mb-2">
                    <label class="input-group-text" for="device-name">Device Name</label>
                    <input type="text" class="form-control sample-info" id="device-name" aria-label="Recording device name" placeholder="Recording device name">
                  </div>

                  <div class="form-floating h-50">
                    <textarea class="form-control sample-info h-100" placeholder="Leave additional notes here" id="add-notes"></textarea>
                    <label for="add-notes">Additional notes</label>
                  </div>

                  <div class="mt-2 mb-3 d-flex">
                    <small class="flex-fill me-1">This data will only be saved to JSON or XML exports.</small>
                    <button class="btn btn-primary btn-sm text-nowrap" type="reset" id="reset-meta-values" title="Clear all sample tags"> <i class="fas fa-trash"></i> Clear All</button>
                  </div>

                </div>
              </div>

            </div>
          </div>

        </div>

        <div class="col-md-auto g-0 bg-dark border-theme">
          <div class="vr h-100 d-none d-md-block"></div>
          <hr class="d-md-none m-0">
        </div>

        <div class="col-md-2 p-2">

          <div id="static-info">
            <h2 class="fs-4">Information</h2>

            <strong>Click Position:</strong>
            <p><span id="click-data">None</span></p>

            <hr>

            <strong>Spectrum:</strong>
            <p class="mb-1"><span id="total-spec-cts">0</span> cts</p>
            <p class="mt-1 mb-2"><span id="spec-time">00:00:00</span></p>

            <strong>Background:</strong>
            <p class="mb-1"><span id="total-bg-cts">0</span> cts</p>
            <p class="mt-1 mb-2"><span id="bg-time">00:00:00</span></p>
          </div>

          <div id="roi-info" class="d-none">
            <h2 class="fs-4">ROI</h2>

            <strong>Range:</strong>
            <p class="mt-1 mb-3"><span id="roi-range">N/A</span> <span id="roi-range-unit">N/A</span></p>

            <strong>Counts:</strong>
            <p class="mb-1">Total: <span id="total-counts">N/A</span> cts</p>
            <p class="mb-1">Net: <span id="net-counts">N/A</span> cts</p>
            <p class="mb-1">Background: <span id="bg-counts">N/A</span> cts</p>
            <p class="mt-1 mb-3">BG ratio: <span id="bg-ratio">N/A</span> %</p>
          </div>

        </div>
      </div>

      <div id="plot-tab" class="row flex-grow-1 plot-div border border-1 border-dark border-theme"> <!-- flex-fill -->
        <div class="col p-1">
          <!--
            PLOT DIV
          -->
          <div class="w-100 h-100" id="plot"></div>
        </div>
      </div>

      <div class="row border border-top-0 border-1 border-dark rounded-bottom-3 border-mode border-theme p-1 d-flex justify-content-center">

        <div class="col-auto p-1">
          <button class="btn btn-primary btn-sm" type="button" id="reset-plot" title="Reset plot settings"> <i class="fas fa-redo"></i> Reset Plot </button>
        </div>

        <div class="col-auto ps-1 pe-1">
          <div class="vr h-100 d-none d-sm-block"></div>
        </div>

        <div class="col-auto p-1">
          <div class="input-group input-group-sm">
            <span class="input-group-text">X</span>
            <button class="btn btn-primary btn-sm" type="button" id="xAxis" title="Toggle x-axis scale">Linear</button>
          </div>
        </div>

        <div class="col-auto p-1">
          <div class="input-group input-group-sm">
            <span class="input-group-text">Y</span>
            <button class="btn btn-primary btn-sm" type="button" id="yAxis" title="Toggle y-axis scale">Linear</button>
          </div>
        </div>

        <div class="col-auto ps-1 pe-1">
          <div class="vr h-100 d-none d-sm-block"></div>
        </div>

        <div class="col-auto p-1">
          <div class="input-group input-group-sm">
            <label class="input-group-text" for="smaVal">SMA Length</label>
            <input class="form-control form-control-sm" type="number" id="smaVal" min="1" max="1000" value="" title="Width of simple moving average">

            <input type="checkbox" class="btn-check" id="sma">
            <label class="btn btn-outline-primary" for="sma" title="Toggle simple moving average">Enable</label>
          </div>
        </div>

        <div class="col-auto ps-1 pe-1">
          <div class="vr h-100 d-none d-sm-block"></div>
        </div>

        <div class="col-auto p-1">
          <div class="input-group input-group-sm">
            <span class="input-group-text">Type</span>
            <button class="btn btn-primary btn-sm" type="button" id="plotType" title="Switch plot type"><i class="fas fa-chart-bar"></i> Bar</button>
          </div>
        </div>

        <div class="col-auto ps-1 pe-1">
          <div class="vr h-100 d-none d-sm-block"></div>
        </div>

        <div class="col-auto p-1">
          <div class="input-group input-group-sm">
            <span class="input-group-text">Counts</span>
            <button class="btn btn-primary btn-sm" type="button" id="plot-cps" title="Switch total or counts per second"> Total </button>
          </div>
        </div>

        <div class="col-auto ps-1 pe-1">
          <div class="vr h-100 d-none d-sm-block"></div>
        </div>

        <div class="col-auto p-1">
          <div class="input-group input-group-sm">
            <span class="input-group-text">Peaks</span>
            <button class="btn btn-primary btn-sm" type="button" id="peak-finder-btn" title="Toggle between Gaussian Correlation Filter, energy and isotope peak finder.">None</button>
          </div>
        </div>

        <div class="col-auto ps-1 pe-1">
          <div class="vr h-100 d-none d-sm-block"></div>
        </div>

        <div class="col-auto p-1">
          <input type="checkbox" class="btn-check" id="iso-hover">
          <label class="btn btn-outline-primary btn-sm" title="Show closest isotope when hovering" for="iso-hover"> <i class="fa-solid fa-magnifying-glass"></i> Isotopes </label>
        </div>

      </div>
    </div>
    <!--

      BOOTSTRAP MODALS FOR SELECTION SCREENS, SERIAL CONSOLE, ...

    -->
    <!-- Record Modal -->
    <div class="modal fade" id="recordModal" tabindex="-1" aria-labelledby="recordModal" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h3 class="modal-title h4">Record Spectrum</h3>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <p><strong>What do you want to record?</strong></p>
            <p>You can either record an energy spectrum or a background energy spectrum. This will change the way the data is plotted and saved.</p>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-primary ser-settings" data-bs-dismiss="modal" title="Record energy spectrum" id="record-spectrum-btn"> Spectrum </button>
            <button type="button" class="btn btn-primary ser-settings" data-bs-dismiss="modal" title="Record background energy spectrum" id="record-bg-btn"> Background </button>
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"> Cancel </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Export Modal -->
    <div class="modal fade" id="exportModal" tabindex="-1" aria-labelledby="exportModal" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h3 class="modal-title h4">Save File</h3>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <p><strong>What do you want to save?</strong></p>
            <p>You can either choose to use one of the combined file types (JSON, XML) or just plain CSVs for the spectrum or background spectrum.</p>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-success" id="npes-export-btn"  title="Export all data as combined JSON (NPES), recommended"> JSON </button>
            <button type="button" class="btn btn-primary" id="xml-export-btn" title="Export all data as combined XML, deprecated"> XML </button>
            <button type="button" class="btn btn-primary" id="download-spectrum-btn" title="Export spectrum as CSV"> Spectrum </button>
            <button type="button" class="btn btn-primary" id="download-bg-btn" title="Export background as CSV"> Background </button>
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"> Cancel </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Serial Console Modal -->
    <div class="modal fade" id="serialConsoleModal" tabindex="-1" aria-labelledby="serialConsoleModal" aria-hidden="true">
      <div class="modal-dialog modal-dialog-scrollable modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h3 id="serial-console-title" class="modal-title h4 flex-fill">Serial Console</h3>

            <div class="g-1 pe-2">
              <input type="checkbox" class="btn-check" id="autoscroll-console">
              <label class="btn btn-sm btn-primary" for="autoscroll-console" title="Toggle Autoscroll"><i class="fa-solid fa-angles-down"></i></label>
              <button type="button" class="btn btn-sm btn-outline-primary" id="reconnect-console-log" title="Reconnect Console (stops all recordings!)"><i class="fa-solid fa-rotate"></i></button>
              <button type="button" class="btn btn-sm btn-outline-primary" id="clear-console-log" title="Clear Console History"><i class="fa-solid fa-trash"></i></button>
            </div>

            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>

          <br>

          <div class="input-group input-group-md p-2">
            <label class="input-group-text" for="ser-command"> <i class="fa-solid fa-terminal"></i> </label>
            <input type="text" class="form-control" id="ser-command" spellcheck="false">
            <button type="button" class="btn btn-primary ser-settings" id="send-command"> <i class="fa-solid fa-share"></i> Send </button>
          </div>

          <hr>

          <div class="modal-body">

            <p class="font-monospace text-nowrap ps-1 pe-1" id="ser-output"></p> <!-- text-break -->

          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"> Close </button>
          </div>
        </div>
      </div>
    </div>
    <!--

      BOOTSTRAP OFFCANVAS FOR SETTINGS, INFO AND ISOTOPE VIEWER

    -->
    <div class="offcanvas offcanvas-start" tabindex="-1" id="offcanvas" aria-labelledby="offcanvasLabel">
      <div class="offcanvas-header">
        <img class="logo" src="/assets/logo.svg" alt="Logo" title="Gamma MCA Logo">
        <h1 class="display-6 offcanvas-title" id="offcanvasLabel">Gamma MCA</h1>
        <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
      </div>

      <div class="offcanvas-body" id="offbody">

        <nav class="nav nav-tabs" role="tablist">
          <button class="nav-link active" data-bs-toggle="tab" data-bs-target="#isotopes" type="button" role="tab" aria-controls="isotopes" aria-selected="true">Isotopes</button>
          <button class="nav-link" data-bs-toggle="tab" data-bs-target="#settings" type="button" role="tab" aria-controls="settings" aria-selected="false">Settings</button>
          <button class="nav-link" data-bs-toggle="tab" data-bs-target="#info" type="button" role="tab" aria-controls="info" aria-selected="false">Info</button>
        </nav>
        <div class="tab-content" id="tabcontent">

          <div class="tab-pane fade show active me-2" id="isotopes" role="tabpanel" aria-labelledby="isotopes">
            <br>

            <h4 class="fs-5">
              Common Gamma-Ray Energies <button type="button" class="btn btn-outline-primary btn-sm float-end" id="reload-isos-btn" title="Reload Isotope List"><i class="fa-solid fa-arrow-rotate-right"></i></button>
            </h4>
            <br>

            <div class="text-center">
              <div class="alert alert-danger d-none" role="alert" id="iso-load-error"></div>

              <div class="alert alert-primary d-none" role="alert" id="iso-loading">
                <div class="spinner-border" role="status">
                  <span class="visually-hidden">Loading...</span>
                </div>
                <p><strong>Loading...</strong></p>
              </div>
            </div>

            <div class="table-responsive"> <!-- style="max-height:70vh;" -->
              <table id="table" class="table table-hover align-middle">
                <caption>List of gamma-ray energies of common isotopes.</caption>
                <thead> <!-- class="table-light" style="box-shadow: inset 1px 1px #000, 0 2px #000;" -->
                  <tr>
                    <th> <input class="form-check-input" id="check-all-isos" type="checkbox" value="" title="Toggle all isotopes"> </th>
                    <th class="cursor-pointer" data-sort-by="1">Isotope <i class="fa-solid fa-sort"></i></th>
                    <th class="cursor-pointer" data-sort-by="2">Energy [keV] <i class="fa-solid fa-sort"></i></th>
                  </tr>
                </thead>

                <tbody class="table-group-divider" id="iso-table"></tbody>

              </table>
            </div>

          </div>
          <div class="tab-pane fade me-2" id="settings" role="tabpanel" aria-labelledby="settings">
            <br>

            <div class="alert alert-success alert-dismissible fade show" role="alert" id="ls-available">
              <i class="fa-solid fa-floppy-disk"></i> Settings will be saved automatically in this browser.
              <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>

            <div class="alert alert-warning alert-dismissible fade show" role="alert" id="ls-unavailable">
              <i class="fa-solid fa-floppy-disk"></i> Settings will <strong>not</strong> be saved!
              <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>

            <div class="accordion accordion-flush">
              <div class="accordion-item">
                <h4 class="accordion-header" id="panel0-heading">
                  <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#panel0-collaps" aria-expanded="true" aria-controls="panel0-collaps">
                    General
                  </button>
                </h4>
                <div id="panel0-collaps" class="accordion-collapse collapse" aria-labelledby="panel0-heading">
                  <div class="accordion-body">

                    <div class="input-group input-group-sm">
                      <label class="input-group-text" for="theme-select">Theme</label>
                      <select class="form-select form-select-sm" id="theme-select" aria-label="Select the Gamma MCA theme">
                        <option value="auto" selected>System (auto)</option>
                        <option value="light">Light</option>
                        <option value="dark">Dark</option>
                      </select>
                    </div>
                    <p><small>Select a theme for Gamma MCA. <code>System</code> will automatically use your system theme.</small></p>

                  </div>
                </div>
              </div>
              <div class="accordion-item">
                <h4 class="accordion-header" id="panel1-heading">
                  <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#panel1-collaps" aria-expanded="true" aria-controls="panel1-collaps">
                    Plot
                  </button>
                </h4>
                <div id="panel1-collaps" class="accordion-collapse collapse" aria-labelledby="panel1-heading">
                  <div class="accordion-body">

                    <div class="form-check form-switch">
                      <input class="form-check-input" type="checkbox" role="switch" id="edit-plot">
                      <label class="form-check-label" for="edit-plot">Editable Plot Labels</label>
                    </div>
                    <p><small>Modify the axes labels, plot title and data names by clicking on them.</small></p>

                    <div class="input-group input-group-sm">
                      <label class="input-group-text" for="iso-hover-prox">Iso Hover Proximity</label>
                      <input type="number" class="form-control" id="iso-hover-prox" min="1">
                      <label class="input-group-text" for="iso-hover-prox">keV</label>
                      <button class="btn btn-primary" type="button" id="iso-hover-prox-btn" title="Apply"> <i class="fas fa-check"></i> </button>
                    </div>
                    <p><small>Any positive integer is valid.</small></p>

                    <div class="input-group input-group-sm">
                      <label class="input-group-text" for="custom-url">Isotope List</label>
                      <input type="url" class="form-control" id="custom-url" spellcheck="false">
                      <button class="btn btn-primary" type="button" id="custom-url-btn" title="Apply"> <i class="fas fa-check"></i> </button>
                    </div>
                    <p><small>File must be of valid JSON format. Use only trusted sources!</small></p>

                    <div class="input-group input-group-sm">
                      <label class="input-group-text" for="download-format">Download Plot</label>
                      <select class="form-select form-select-sm" id="download-format" aria-label="Plot download file format">
                        <option value="png" selected>.png</option>
                        <option value="svg">.svg</option>
                        <option value="jpeg">.jpeg</option>
                        <option value="webp">.webp</option>
                      </select>
                    </div>
                    <p><small>File format for downloading a static plot. SVG looks the best.</small></p>

                    <div class="form-check form-switch">
                      <input class="form-check-input" type="checkbox" role="switch" id="fwhm-fast">
                      <label class="form-check-label" for="fwhm-fast">FWHM Fast Mode</label>
                    </div>
                    <p><small>Better FWHM calculation performance by assuming symmetrical peaks.</small></p>

                  </div>
                </div>
              </div>
              <div class="accordion-item">
                <h4 class="accordion-header" id="panel2-heading">
                  <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#panel2-collapse" aria-expanded="false" aria-controls="panel2-collapse">
                    File Import
                  </button>
                </h4>
                <div id="panel2-collapse" class="accordion-collapse collapse" aria-labelledby="panel2-heading">
                  <div class="accordion-body">

                    <div class="input-group input-group-sm">
                      <label class="input-group-text" for="custom-delimiter">CSV File Delimiter</label>
                      <input type="text" class="form-control" id="custom-delimiter" spellcheck="false">
                      <button class="btn btn-primary" type="button" id="custom-delimiter-btn" title="Apply"> <i class="fas fa-check"></i> </button>
                    </div>
                    <p><small>Any character is valid.</small></p>

                    <div class="input-group input-group-sm">
                      <label class="input-group-text" for="custom-file-adc">RAW Stream Channel No</label>
                      <input type="number" class="form-control" id="custom-file-adc" min="1">
                      <button class="btn btn-primary" type="button" id="custom-file-adc-btn" title="Apply"> <i class="fas fa-check"></i> </button>
                    </div>
                    <p><small>Number of (ADC) channels of the original device. Any positive integer is valid.</small></p>

                  </div>
                </div>
              </div>
              <div class="accordion-item">
                <h4 class="accordion-header" id="panel3-heading">
                  <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#panel3-collapse" aria-expanded="false" aria-controls="panel3-collapse">
                    Serial Connection
                  </button>
                </h4>
                <div id="panel3-collapse" class="accordion-collapse collapse" aria-labelledby="panel3-heading">
                  <div class="accordion-body">

                    <div class="input-group input-group-sm">
                      <label class="input-group-text" for="custom-baud">Baud Rate</label>
                      <input type="number" class="form-control serial-controls" id="custom-baud" min="1">
                      <label class="input-group-text" for="custom-baud">bps</label>
                      <button class="btn btn-primary serial-controls" type="button" id="custom-baud-btn" title="Apply"> <i class="fas fa-check"></i> </button>
                    </div>
                    <p><small>Any positive integer is valid.</small></p>

                    <div class="input-group input-group-sm">
                      <label class="input-group-text" for="eol-char">EOL character</label>
                      <input type="text" class="form-control serial-controls" id="eol-char" spellcheck="false">
                      <button class="btn btn-primary serial-controls" type="button" id="eol-char-btn" title="Apply"> <i class="fas fa-check"></i> </button>
                    </div>
                    <p><small>Character transmitted at the end of every single data point. Any character is valid.</small></p>

                    <div class="form-check form-switch">
                      <input class="form-check-input serial-controls" type="checkbox" role="switch" id="toggle-time-limit">
                      <label class="form-check-label" for="toggle-time-limit">Enable Time Limit</label>
                    </div>

                    <div class="input-group input-group-sm">
                      <label class="input-group-text" for="ser-limit-h">Time Limit</label>
                      <input type="number" class="form-control serial-controls" id="ser-limit-h"  min="0" max="744" step="1" placeholder="hour">
                      <input type="number" class="form-control serial-controls" id="ser-limit-m"  min="0" max="59" step="1" placeholder="min">
                      <input type="number" class="form-control serial-controls" id="ser-limit-s"  min="0" max="59" step="1" placeholder="sec">
                      <button class="btn btn-primary serial-controls" id="ser-limit-h-btn" type="button" title="Apply"> <i class="fas fa-check"></i> </button>
                    </div>
                    <p><small>Formatted as <code>hh:mm:ss</code>. Any positive integer is valid. Serial recording will stop automatically when time runs out.</small></p>

                    <div class="input-group input-group-sm">
                      <label class="input-group-text" for="custom-ser-refresh">Data Refresh Time</label>
                      <input type="number" class="form-control serial-controls" id="custom-ser-refresh" min="1">
                      <label class="input-group-text" for="custom-ser-refresh">s</label>
                      <button class="btn btn-primary serial-controls" type="button" id="custom-ser-refresh-btn" title="Apply"> <i class="fas fa-check"></i> </button>
                    </div>
                    <p><small>Determines how often the plot and the data are updated. Any positive float is valid, use integers for best performance.</small></p>

                    <div class="input-group input-group-sm">
                      <label class="input-group-text" for="custom-ser-buffer">Max Serial Buffer</label>
                      <input type="number" class="form-control serial-controls" id="custom-ser-buffer" min="1">
                      <button class="btn btn-primary serial-controls" type="button" id="custom-ser-buffer-btn" title="Apply"> <i class="fas fa-check"></i> </button>
                    </div>
                    <p><small>Max number of serial input events buffered between plot refreshes. Any positive integer is valid.</small></p>

                    <div class="input-group input-group-sm">
                      <label class="input-group-text" for="custom-ser-adc">Serial Channel No</label>
                      <input type="number" class="form-control serial-controls" id="custom-ser-adc" min="1">
                      <button class="btn btn-primary serial-controls" type="button" id="custom-ser-adc-btn" title="Apply"> <i class="fas fa-check"></i> </button>
                    </div>
                    <p><small>Number of (ADC) channels of the serial device. Any positive integer is valid.</small></p>

                  </div>
                </div>
              </div>
              <div class="accordion-item">
                <h4 class="accordion-header" id="panel4-heading">
                  <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#panel4-collapse" aria-expanded="false" aria-controls="panel4-collapse">
                    Energy Peak Detection
                  </button>
                </h4>
                <div id="panel4-collapse" class="accordion-collapse collapse" aria-labelledby="panel4-heading">
                  <div class="accordion-body">

                    <div class="form-check form-switch">
                      <input class="form-check-input" type="checkbox" role="switch" id="enable-res">
                      <label class="form-check-label" for="enable-res">Show Energy Resolution</label>
                    </div>
                    <p><small>Automatically compute the energy resolution of all the peaks.</small></p>

                    <div class="form-check form-switch">
                      <input class="form-check-input" type="checkbox" role="switch" id="new-flags">
                      <label class="form-check-label" for="new-flags">New Highlighting Style</label>
                    </div>
                    <p><small>Use the new highlighting style for the peak finder. Turn off to use the old style.</small></p>

                    <div class="input-group input-group-sm">
                      <label class="input-group-text" for="gauss-sigma">Gaussian Filter &sigma;</label>
                      <input type="number" class="form-control" id="gauss-sigma" min="1" step="1">
                      <button class="btn btn-primary" type="button" id="gauss-sigma-btn" title="Apply"> <i class="fas fa-check"></i> </button>
                    </div>
                    <p><small>Defines how many standard deviations of the peak the Gaussian shape is covering. 2 equals 95% coverage. Any positive integer is valid.</small></p>

                    <div class="input-group input-group-sm">
                      <label class="input-group-text" for="peak-lag">Smoothing</label>
                      <input type="number" class="form-control" id="peak-lag" min="1">
                      <button class="btn btn-primary" type="button" id="peak-lag-btn" title="Apply"> <i class="fas fa-check"></i> </button>
                    </div>
                    <p><small>Decrease this if your data already looks pretty smooth, increase otherwise. Too high values can hide smaller peaks, too low values might generate false-positives. Any positive integer is valid.</small></p>

                    <div class="input-group input-group-sm">
                      <label class="input-group-text" for="peak-thres">Threshold</label>
                      <input type="number" class="form-control" id="peak-thres" min="0" step="0.0005">
                      <button class="btn btn-primary" type="button" id="peak-thres-btn" title="Apply"> <i class="fas fa-check"></i> </button>
                    </div>
                    <p><small>Change this after adapting the <code>Smoothing</code> setting. Decreasing this will make the peak finder trigger on lower-amplitude peaks and vice versa. Any positive float is valid.</small></p>

                    <div class="input-group input-group-sm">
                      <label class="input-group-text" for="seek-width">Isotope Seek</label>
                      <input type="number" class="form-control" id="seek-width" min="1">
                      <button class="btn btn-primary" type="button" id="seek-width-btn" title="Apply"> <i class="fas fa-check"></i> </button>
                    </div>
                    <p><small>Maximum distance to search for isotopes around the peak energy (multiple of the peak width in bins). Any positive float is valid.</small></p>

                  </div>
                </div>
              </div>
            </div>

          </div>
          <div class="tab-pane fade me-2" id="info" role="tabpanel" aria-labelledby="info">
            <br>
            <p>Gamma MCA is a complete progressive web app for gamma spectroscopy. It is free and open-source with online and offline functionality. You can import and export spectrum files or record new ones using the serial interface.</p>

            <p>For a list of example spectra to help you get started head to the <a class="link-primary link-offset-2 link-underline-opacity-25 link-underline-opacity-100-hover" title="GammaDB" href="https://gammadb.nuclearphoenix.xyz" target="_blank">Gamma Spectrum Database</a>.</p>

            <p>For more information on the JSON file format head to the <abbr title="Nuclear Physics Energy Spectrum">NPES</abbr>-JSON <a class="link-primary link-offset-2 link-underline-opacity-25 link-underline-opacity-100-hover" title="GitHub/NPES-JSON" href="https://github.com/OpenGammaProject/NPES-JSON" target="_blank">GitHub repository</a>.</p>

            <hr>

            <p>Made free and open-source by <a class="link-primary link-offset-2 link-underline-opacity-25 link-underline-opacity-100-hover" title="NuclearPhoenix.xyz" href="https://nuclearphoenix.xyz" target="_blank">NuclearPhoenix</a>. Licensed under the <a class="link-primary link-offset-2 link-underline-opacity-25 link-underline-opacity-100-hover" title="GitHub/License" href="https://github.com/OpenGammaProject/Gamma-MCA/blob/main/LICENSE" target="_blank">GNU General Public License v3.0</a>.</p>

            <p>This site is part of the <a class="link-primary link-offset-2 link-underline-opacity-25 link-underline-opacity-100-hover" title="Open Gamma Project" href="https://github.com/OpenGammaProject" target="_blank">Open Gamma Project</a> to provide modern and open-source resources for accessible gamma-spectroscopy.</p>

            <p>Get the source code on <a class="link-primary link-offset-2 link-underline-opacity-25 link-underline-opacity-100-hover" title="GitHub/Gamma-MCA" href="https://github.com/OpenGammaProject/Gamma-MCA" target="_blank"><i class="fab fa-github" aria-hidden="true"></i> GitHub</a>.</p>
            <p>Report issues and bugs on <a class="link-primary link-offset-2 link-underline-opacity-25 link-underline-opacity-100-hover" title="GitHub/Issues" href="https://github.com/OpenGammaProject/Gamma-MCA/issues" target="_blank"><i class="fas fa-bug" aria-hidden="true"></i> GitHub/Issues</a>.</p>
            <p>Questions? Discussions, Q&amp;As and more can be found on <a class="link-primary link-offset-2 link-underline-opacity-25 link-underline-opacity-100-hover" title="GitHub/Discussions" href="https://github.com/OpenGammaProject/Gamma-MCA/discussions" target="_blank"><i class="fas fa-comments" aria-hidden="true"></i> GitHub/Discussions</a>.</p>

            <hr>

            <p><span id="version-tag">Version </span> <a class="float-end" href="https://hits.seeyoufarm.com"><img src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fspectrum.nuclearphoenix.xyz&count_bg=%2379C83D&title_bg=%23555555&icon=&icon_color=%23E7E7E7&title=hits&edge_flat=true" alt="Total Hits" title="Total Hits" loading="lazy"></a> </p>

            <div class="d-none" id="manual-install">
              <hr>

              <button type="button" class="btn btn-primary btn-sm" id="install-pwa-btn" title="Install Gamma MCA"><i class="fa-solid fa-download"></i> Install MCA</button>

              <p><small>Install Gamma MCA (<abbr title="Progressive Web App">PWA</abbr>) on this device. It will behave like any other native app and will work outside this browser.</small></p>
            </div>

            <hr>

            <button type="button" class="btn btn-danger btn-sm" title="Reset Gamma MCA" id="reset-gamma-mca"><i class="fa-solid fa-arrow-rotate-right"></i> Reset MCA</button>

            <p><small>Clears all settings, browser storage and reloads the page.</small></p>

          </div>

        </div>

      </div>
    </div>
    <!--

      BOOTSTRAP TOASTS FOR NOTIFICATIONS: LEGACY NOW; THE REST IS DONE BY THE NOTIFICATION SYSTEM

    -->
    <div id="toast-container" class="toast-container position-fixed bottom-0 end-0 p-3"> <!-- add z-3 for z-index? -->
      
      <div id="pwa-installer" class="toast text-bg-primary" role="alert" aria-live="assertive" aria-atomic="true" data-bs-autohide="false">
        <div class="toast-header">
          <i class="fa-solid fa-download me-2"></i>
          <strong class="me-auto">Install App?</strong>
          <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
        </div>
        <div class="toast-body">
          <p>Gamma MCA is a progressive web app! You can install it to use Gamma MCA standalone and offline like any native program.</p>
          <p>Do you want to install?</p>
          <div class="mt-2 pt-2 border-top">
            <button type="button" class="btn btn-light btn-sm" id="install-pwa-toast-btn" title="Install Gamma MCA">Install</button>
            <button type="button" class="btn btn-primary btn-sm" title="Dismiss" data-bs-dismiss="toast">No</button>
          </div>
        </div>
      </div>

    </div>
  </body>
</html>
